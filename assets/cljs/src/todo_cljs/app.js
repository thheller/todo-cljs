goog.provide('todo_cljs.app');
goog.require('cljs.core');
goog.require('shadow.api');
goog.require('shadow.ui');
goog.require('shadow.ui');
goog.require('shadow.dom');
goog.require('shadow.dom');
goog.require('shadow.object');
goog.require('shadow.object');
todo_cljs.app.stored_todos = shadow.ui.store_locally(cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentVector.EMPTY),new cljs.core.Keyword(null,"todos","todos",1124439135));
todo_cljs.app.todo_next_id = (function (){var id_seq = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(0);return (function (){return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$2(id_seq,cljs.core.inc);
});
})();
shadow.object.define.cljs$core$IFn$_invoke$arity$variadic(new cljs.core.Keyword("todo-cljs.app","todo-item","todo-cljs.app/todo-item",3693900611),cljs.core.array_seq([new cljs.core.Keyword(null,"dom","dom",1014003892),(function (p__14398){var map__14399 = p__14398;var map__14399__$1 = ((cljs.core.seq_QMARK_(map__14399))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__14399):map__14399);var this$ = map__14399__$1;var todo = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__14399__$1,new cljs.core.Keyword(null,"todo","todo",1017469880));return new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"li","li",1013907695),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",1108647146),(cljs.core.truth_(new cljs.core.Keyword(null,"done","done",1016993524).cljs$core$IFn$_invoke$arity$1(todo))?"completed":null)], null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.view","div.view",1324225876),shadow.ui.dom_checkbox.cljs$core$IFn$_invoke$arity$3(this$,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todo","todo",1017469880),new cljs.core.Keyword(null,"done","done",1016993524)], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",1108647146),"toggle"], null)),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"label","label",1116631654),shadow.object.bind_simple.cljs$core$IFn$_invoke$arity$3(this$,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todo","todo",1017469880),new cljs.core.Keyword(null,"text","text",1017460895)], null),cljs.core.str)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"button.destroy","button.destroy",1373730992),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"type","type",1017479852),"normal"], null)], null)], null),shadow.ui.dom_input(this$,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todo","todo",1017469880),new cljs.core.Keyword(null,"text","text",1017460895)], null),shadow.ui.text_type,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"class","class",1108647146),"edit",new cljs.core.Keyword(null,"capture","capture",1566489272),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"enter","enter",1110571594),null], null), null)], null))], null);
}),new cljs.core.Keyword("dom","events","dom/events",4023911321),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),"button.destroy"], null),(function (this$,e,el){shadow.dom.ev_stop.cljs$core$IFn$_invoke$arity$1(e);
return shadow.object.remove_in_parent_BANG_(this$);
}),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"dblclick","dblclick",3463991820),"label"], null),(function (this$,e,el){shadow.dom.add_class(this$,"editing");
return shadow.dom.query_one.cljs$core$IFn$_invoke$arity$2("input.edit",this$).focus();
})], null),new cljs.core.Keyword(null,"watch","watch",1126807617),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todo","todo",1017469880),(function (this$,old,p__14400){var map__14401 = p__14400;var map__14401__$1 = ((cljs.core.seq_QMARK_(map__14401))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__14401):map__14401);var new$ = map__14401__$1;var done = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__14401__$1,new cljs.core.Keyword(null,"done","done",1016993524));return shadow.dom.toggle_class.cljs$core$IFn$_invoke$arity$3(this$,"completed",done);
})], null),new cljs.core.Keyword(null,"on","on",1013907793),new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("input","change","input/change",1724873674),(function (this$,a,v,i){if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(a,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todo","todo",1017469880),new cljs.core.Keyword(null,"done","done",1016993524)], null)))
{return shadow.object.update_BANG_.cljs$core$IFn$_invoke$arity$variadic(this$,cljs.core.assoc_in,cljs.core.array_seq([a,v], 0));
} else
{return null;
}
}),new cljs.core.Keyword("input","enter","input/enter",3219888258),(function (this$,a,v,i){shadow.object.update_BANG_.cljs$core$IFn$_invoke$arity$variadic(this$,cljs.core.assoc_in,cljs.core.array_seq([a,v], 0));
return shadow.dom.remove_class(this$,"editing");
}),new cljs.core.Keyword("input","blur","input/blur",3111690001),(function (this$,a,i){(shadow.object.notify_down_BANG_.cljs$core$IFn$_invoke$arity$3 ? shadow.object.notify_down_BANG_.cljs$core$IFn$_invoke$arity$3(this$,new cljs.core.Keyword("input","set-values","input/set-values",541255307),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"todo","todo",1017469880),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"text","text",1017460895),cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(this$,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todo","todo",1017469880),new cljs.core.Keyword(null,"text","text",1017460895)], null))], null)], null)) : shadow.object.notify_down_BANG_.call(null,this$,new cljs.core.Keyword("input","set-values","input/set-values",541255307),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"todo","todo",1017469880),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"text","text",1017460895),cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(this$,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todo","todo",1017469880),new cljs.core.Keyword(null,"text","text",1017460895)], null))], null)], null)));
return shadow.dom.remove_class(this$,"editing");
})], null)], 0));
shadow.object.define.cljs$core$IFn$_invoke$arity$variadic(new cljs.core.Keyword("todo-cljs.app","app","todo-cljs.app/app",781617562),cljs.core.array_seq([new cljs.core.Keyword(null,"defaults","defaults",1658185156),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"todos-left","todos-left",2182455385),0,new cljs.core.Keyword(null,"todos-completed","todos-completed",3829459165),0,new cljs.core.Keyword(null,"todos","todos",1124439135),cljs.core.PersistentVector.EMPTY], null),new cljs.core.Keyword(null,"dom","dom",1014003892),(function (this$){return new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"section#todoapp","section#todoapp",4596089839),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"header#header","header#header",3054273717),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h1","h1",1013907515),"todos"], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"form#todo-form","form#todo-form",2177586270),shadow.ui.dom_input(this$,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"new-todo","new-todo",2345064389)], null),shadow.ui.text_type,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"id","id",1013907597),"new-todo",new cljs.core.Keyword(null,"autofocus","autofocus",2681511931),true,new cljs.core.Keyword(null,"placeholder","placeholder",1612151013),"What needs to be done?"], null))], null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"section#main","section#main",1608792073),shadow.object.bind_children.cljs$core$IFn$_invoke$arity$5(new cljs.core.Keyword(null,"ul#todo-list","ul#todo-list",2597326411),this$,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todos","todos",1124439135)], null),new cljs.core.Keyword("todo-cljs.app","todo-item","todo-cljs.app/todo-item",3693900611),new cljs.core.Keyword(null,"todo","todo",1017469880))], null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"footer#footer","footer#footer",2352584949),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span#todo-count","span#todo-count",1165286163),shadow.object.bind_simple.cljs$core$IFn$_invoke$arity$3(this$,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todos-left","todos-left",2182455385)], null),(function (p1__14402_SHARP_){return [cljs.core.str(p1__14402_SHARP_),cljs.core.str(" items left")].join('');
}))], null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"ul#filters","ul#filters",1874346369),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"li","li",1013907695),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"a","a",1013904339),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"href","href",1017115293),"#/"], null),"All"], null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"li","li",1013907695),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"a","a",1013904339),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"href","href",1017115293),"#/active"], null),"Active"], null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"li","li",1013907695),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"a","a",1013904339),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"href","href",1017115293),"#/completed"], null),"Completed"], null)], null)], null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"button#clear-completed","button#clear-completed",1473224428),"Clear completed (",shadow.object.bind_simple.cljs$core$IFn$_invoke$arity$3(this$,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todos-completed","todos-completed",3829459165)], null),cljs.core.str),")"], null)], null)], null);
}),new cljs.core.Keyword("dom","events","dom/events",4023911321),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"submit","submit",4417336202),"form#todo-form"], null),(function add_new_todo(p__14404,e){var map__14406 = p__14404;var map__14406__$1 = ((cljs.core.seq_QMARK_(map__14406))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__14406):map__14406);var this$ = map__14406__$1;var new_todo = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__14406__$1,new cljs.core.Keyword(null,"new-todo","new-todo",2345064389));shadow.dom.ev_stop.cljs$core$IFn$_invoke$arity$1(e);
if(cljs.core.seq(new_todo))
{console.log(shadow.object.console_friendly("new-todo"),shadow.object.console_friendly(new_todo));
shadow.object.update_BANG_.cljs$core$IFn$_invoke$arity$variadic(this$,cljs.core.update_in,cljs.core.array_seq([new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todos","todos",1124439135)], null),cljs.core.conj,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"id","id",1013907597),(todo_cljs.app.todo_next_id.cljs$core$IFn$_invoke$arity$0 ? todo_cljs.app.todo_next_id.cljs$core$IFn$_invoke$arity$0() : todo_cljs.app.todo_next_id.call(null)),new cljs.core.Keyword(null,"text","text",1017460895),new_todo,new cljs.core.Keyword(null,"done","done",1016993524),false], null)], 0));
return (shadow.object.notify_down_BANG_.cljs$core$IFn$_invoke$arity$3 ? shadow.object.notify_down_BANG_.cljs$core$IFn$_invoke$arity$3(this$,new cljs.core.Keyword("input","set-values","input/set-values",541255307),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"new-todo","new-todo",2345064389),""], null)) : shadow.object.notify_down_BANG_.call(null,this$,new cljs.core.Keyword("input","set-values","input/set-values",541255307),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"new-todo","new-todo",2345064389),""], null)));
} else
{return null;
}
}),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),"#clear-completed"], null),(function (this$,e){shadow.dom.ev_stop.cljs$core$IFn$_invoke$arity$1(e);
return shadow.object.update_BANG_.cljs$core$IFn$_invoke$arity$variadic(this$,cljs.core.update_in,cljs.core.array_seq([new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todos","todos",1124439135)], null),(function (p1__14403_SHARP_){return cljs.core.vec(cljs.core.remove(new cljs.core.Keyword(null,"done","done",1016993524),p1__14403_SHARP_));
})], 0));
})], null),new cljs.core.Keyword(null,"watch","watch",1126807617),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"todos","todos",1124439135),(function (this$,old,new$){cljs.core.reset_BANG_(todo_cljs.app.stored_todos,new$);
var grouped = cljs.core.group_by(new cljs.core.Keyword(null,"done","done",1016993524),new$);var todos_completed = cljs.core.count(cljs.core.get.cljs$core$IFn$_invoke$arity$2(grouped,true));shadow.object.update_BANG_.cljs$core$IFn$_invoke$arity$variadic(this$,cljs.core.merge,cljs.core.array_seq([new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"todos-left","todos-left",2182455385),cljs.core.count(cljs.core.get.cljs$core$IFn$_invoke$arity$2(grouped,false)),new cljs.core.Keyword(null,"todos-completed","todos-completed",3829459165),todos_completed], null)], 0));
return shadow.dom.toggle_class.cljs$core$IFn$_invoke$arity$3(this$,"has-completed",(todos_completed > 0));
})], null),new cljs.core.Keyword(null,"on","on",1013907793),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("input","change","input/change",1724873674),(function (this$,a,v,i){return shadow.object.update_BANG_.cljs$core$IFn$_invoke$arity$variadic(this$,cljs.core.assoc_in,cljs.core.array_seq([a,v], 0));
}),new cljs.core.Keyword("bind","update","bind/update",4665764005),(function (this$,a,v){return shadow.object.update_BANG_.cljs$core$IFn$_invoke$arity$variadic(this$,cljs.core.assoc_in,cljs.core.array_seq([a,v], 0));
})], null)], 0));
todo_cljs.app.todo_mvc = (function todo_mvc(container){console.log(shadow.object.console_friendly("todo-mvc starting"));
var app = shadow.object.create(new cljs.core.Keyword("todo-cljs.app","app","todo-cljs.app/app",781617562),cljs.core.PersistentArrayMap.EMPTY);shadow.dom.replace_node(container,app);
return shadow.object.update_BANG_.cljs$core$IFn$_invoke$arity$variadic(app,cljs.core.assoc,cljs.core.array_seq([new cljs.core.Keyword(null,"todos","todos",1124439135),cljs.core.deref(todo_cljs.app.stored_todos)], 0));
});
goog.exportSymbol('todo_cljs.app.todo_mvc', todo_cljs.app.todo_mvc);
shadow.api.ns_ready("todo-cljs.app");
//# sourceMappingURL=app.js.map